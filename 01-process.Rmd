---
title: "Preprocess data"
author: "Matti Vuorre"
date: "`r Sys.Date()`"
output: 
  html_document: default
editor_options:
  chunk_output_type: console
---

```{r setup, include = FALSE}
library(tidyverse)
library(anytime)
library(fst)
```

# Preprocessing

Read and clean data collected from Steam API and SteamDB.

```{r}
load("data-raw/preliminary_test_data.rda")
steam <- test.df %>% 
  as_tibble() %>% 
  rename(title = name.x)
rm(test.df)
```

```{r}
# Replace timestamps in variable names with readable date strings
names(steam)[88:7513] <- as.character(anydate(as.numeric(names(steam)[88:7513])))
```

```{r}
# Exclude early data and later data where scraping is incomplete
steam <- steam %>% 
  select(1:87, `2010-01-01`:`2020-04-12`)
```

```{r}
# Save data to disk
format(object.size(steam), "Mb")
dir.create("data", showWarnings = FALSE)
write_fst(steam, "data/steam.fst")
```
